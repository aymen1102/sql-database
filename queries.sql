USE sql_store;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT * 
FROM customers
ORDER BY first_name;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT * 
FROM customers
ORDER BY first_name DESC;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT first_name, last_name
FROM customers;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT 
	first_name, 
    last_name, 
    points, 
    points + 10
FROM customers;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT 
	first_name, 
    last_name, 
    points, 
    (points + 10) * 100 
FROM customers;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT 
	first_name, 
    last_name, 
    points, 
    (points + 10) * 100 AS 'discount_factor'
FROM customers;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT state
FROM customers;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT DISTINCT state
FROM customers;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT 
	name,
    unit_price,
    unit_price * 1.1 AS 'new_price'
FROM products;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE points > 3000;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE state = 'VA';
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE state <> 'VA';
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE birth_date > '1990-01-01';
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM orders
WHERE order_date >= '2019-01-01';
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers WHERE birth_date > '1990-01-01' AND points > 1000;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE birth_date > '1990-01-01' OR points > 1000;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE (birth_date > '1990-01-01' OR points > 1000) AND state='VA';
-------------------------------------------------------------------------------------------- --------------------------------------------------------------------
SELECT *
FROM customers
WHERE NOT (birth_date > '1990-01-01' OR points > 1000);
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE state='VA' OR state='FL' OR state='GA';
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE state IN ('VA','FL','GA');
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE state NOT IN ('VA','FL','GA');
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM products
WHERE quantity_in_stock IN (49,38,72);
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE points >= 1000 AND points <= 3000;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE points BETWEEN 1000 AND 3000;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE last_name LIKE '%field';
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE last_name REGEXP 'field';
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE last_name REGEXP 'field|mac';
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE phone IS NULL;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
WHERE phone IS NOT NULL;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM orders
WHERE shipper_id IS NULL; 
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
ORDER BY state, first_name;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
ORDER BY state DESC, first_name DESC;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT first_name, last_name, 10 AS points
FROM customers
ORDER BY points, first_name;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM order_items
WHERE order_id = 2
ORDER BY (unit_price * quantity) DESC;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *, (unit_price * quantity) AS total_price
FROM order_items
WHERE order_id = 2
ORDER BY total_price DESC;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
LIMIT 3;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
LIMIT 6, 3;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers
ORDER BY points DESC
LIMIT 6, 3;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM orders
JOIN customers;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM orders
JOIN customers
	ON orders.customer_id = customers.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM orders, customers
WHERE orders.customer_id = customers.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT order_id, first_name, last_name
FROM orders
JOIN customers
	ON orders.customer_id = customers.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT order_id, orders.customer_id, first_name, last_name
FROM orders
JOIN customers
	ON orders.customer_id = customers.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT order_id, o.customer_id, first_name, last_name
FROM orders o
JOIN customers c
	ON o.customer_id = c.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT oi.order_id, oi.product_id, p.name, oi.quantity, oi.unit_price
FROM order_items oi
JOIN  products p
	ON oi.product_id = p.product_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM order_items oi
JOIN  sql_inventory.products p
	ON oi.product_id = p.product_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM order_items oi
JOIN  products p
	ON oi.product_id = p.product_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
USE sql_hr;

SELECT * 
FROM employees;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
-- SELF JOIN --
SELECT e.employee_id, e.first_name, m.first_name AS manager_first_name, m.last_name AS manager_last_name
FROM employees e
JOIN employees m
	ON e.reports_to = m.employee_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
USE sql_store;
SELECT o.order_id, o.order_date, c.first_name, c.last_name, os.name AS status
FROM orders o
JOIN customers c
	ON o.customer_id = c.customer_id
JOIN order_statuses os
	ON o.status = os.order_status_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
USE sql_invoicing;
SELECT p.payment_id, p.client_id, c.name AS client_name, pm.name AS payment_method_name
FROM payments p
JOIN clients c
	ON p.client_id = c.client_id
JOIN payment_methods pm
	ON p.payment_method = pm.payment_method_id; 
----------------------------------------------------------------------------------------------------------------------------------------------------------------
USE sql_store;
SELECT *
FROM order_items oi
JOIN order_item_notes oin
	ON oi.order_id = oin.order_id AND
       oi.product_id = oin.product_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT c.customer_id, c.first_name, o.order_id
FROM customers c
JOIN orders o
	ON c.customer_id = o.customer_id
ORDER BY c.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT c.customer_id, c.first_name, o.order_id
FROM customers c
LEFT JOIN orders o
	ON c.customer_id = o.customer_id
ORDER BY c.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT c.customer_id, c.first_name, o.order_id
FROM customers c
RIGHT JOIN orders o
	ON c.customer_id = o.customer_id
ORDER BY c.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT c.customer_id, c.first_name, o.order_id
FROM orders o
RIGHT JOIN customers c
	ON c.customer_id = o.customer_id
ORDER BY c.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT p.product_id, p.name, oi.quantity
FROM products p
LEFT JOIN order_items oi
	ON p.product_id = oi.product_id
ORDER BY p.product_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT c.customer_id,  c.first_name, o.order_id, o.shipper_id
FROM customers c
JOIN orders o
	ON c.customer_id = o.customer_id
ORDER BY c.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT c.customer_id,  c.first_name, o.order_id, o.shipper_id
FROM customers c
LEFT JOIN orders o
	ON c.customer_id = o.customer_id
ORDER BY c.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT c.customer_id,  c.first_name, o.order_id, o.shipper_id, s.name AS shipper
FROM customers c
LEFT JOIN orders o
	ON c.customer_id = o.customer_id
JOIN shippers s
	ON o.shipper_id = s.shipper_id
ORDER BY c.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT c.customer_id,  c.first_name, o.order_id, o.shipper_id, s.name AS shipper
FROM customers c
LEFT JOIN orders o
	ON c.customer_id = o.customer_id
LEFT JOIN shippers s
	ON o.shipper_id = s.shipper_id
ORDER BY c.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT o.order_date, o.order_id, c.first_name AS customer, s.name AS shipper, os.name AS status
FROM orders o
JOIN customers c
	ON o.customer_id = c.customer_id
LEFT JOIN shippers s
	ON o.shipper_id = s.shipper_id
JOIN order_statuses os
	ON o.status = os.order_status_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customer c
JOIN orders o
	ON c.customer_id = o.customer_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM customers c
JOIN orders o
	USING(customer_id);
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT o.order_date, o.order_id, c.first_name AS customer, s.name AS shipper
FROM orders o
JOIN customers c
	USING (customer_id)
LEFT JOIN shippers s
	USING (shipper_id);
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM order_items oi
JOIN order_item_notes oin
	ON oi.order_id = oin.order_id AND
		oi.product_id = oin.product_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM order_items oi
JOIN order_item_notes oin
	USING (order_id, product_id);
----------------------------------------------------------------------------------------------------------------------------------------------------------------
USE sql_invoicing;
SELECT p.date, c.name AS client, p.amount, pm.name AS payment_method
FROM payments p
JOIN clients c
	USING (client_id)
JOIN payment_methods pm
	ON p.payment_method = pm.payment_method_id;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
USE sql_store;
SELECT * FROM customers;
SELECT * FROM products;
SELECT c.customer_id, p.product_id, c.first_name AS customer, p.name AS product
FROM customers c
CROSS JOIN products p
ORDER BY c.first_name;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT c.customer_id, p.product_id, c.first_name AS customer, p.name AS product
FROM customers c, products p
ORDER BY c.first_name;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM shippers s
CROSS JOIN products p;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM shippers s, products p;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT *
FROM orders o
WHERE order_date >= '2019-01-01';
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT o.order_id, o.order_date, 'Active' AS status
FROM orders o
WHERE order_date >= '2019-01-01'; 
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT o.order_id, o.order_date, 'Archived' AS status
FROM orders o
WHERE order_date < '2019-01-01'; 
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT o.order_id, o.order_date, 'Active' AS status
FROM orders o
WHERE order_date >= '2019-01-01'
UNION
SELECT o.order_id, o.order_date, 'Archived' AS status
FROM orders o
WHERE order_date < '2019-01-01'; 
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT c.first_name
FROM customers c
UNION
SELECT s.name
FROM shippers s;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 INSERT INTO customers
 VALUES (DEFAULT, 'John', 'Smith', '1990-01-01', NULL, 'address', 'city', 'CA',DEFAULT);
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 INSERT INTO customers (first_name, last_name, birth_date, address, city, state)
 VALUES ('Aymen', 'Baroudi', '1990-01-01', 'address', 'city', 'CA');
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT * FROM customers;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 INSERT INTO shippers (name)
 VALUES ('shipper 1'),('shipper2'),('shipper 3');
----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT * FROM shippers;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 SELECT * FROM orders;
 INSERT INTO orders (customer_id, order_date, status)
 VALUES (1, '2019-01-02', 1);
 
 INSERT INTO order_items
 VALUES (LAST_INSERT_ID(), 1, 1, 2.95),
		(LAST_INSERT_ID(), 2, 1, 3.95);
SELECT * FROM order_items;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
CREATE TABLE orders_archived AS
SELECT * FROM orders;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
INSERT INTO orders_archived
SELECT *
FROM orders
WHERE order_date < '2019-01-01';
----------------------------------------------------------------------------------------------------------------------------------------------------------------
USE sql_invoicing;
CREATE TABLE invoices_archived AS
SELECT i.invoice_id, i.number, c.name AS client, i.invoice_total, i.payment_total,i.invoice_date,i.payment_date,i.due_date
FROM invoices i
JOIN clients c
	USING(client_id)
WHERE payment_date IS NOT NULL;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
UPDATE invoices
SET payment_total = DEFAULT, payment_date = NULL
WHERE invoice_id = 1;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
UPDATE invoices
SET payment_total = invoice_total * 0.5, payment_date = NULL, payment_date = due_date
WHERE invoice_id = 1;
SELECT * FROM invoices;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
UPDATE invoices
SET payment_total = invoice_total * 0.5, payment_date = due_date
WHERE client_id IN (4,5);
SELECT * FROM invoices;
----------------------------------------------------------------------------------------------------------------------------------------------------------------
USE sql_store;
SELECT * FROM customers;
UPDATE customers
SET points = points + 50
WHERE birth_date < '1990-01-01';
----------------------------------------------------------------------------------------------------------------------------------------------------------------
USE sql_invoicing;
UPDATE invoices
SET payment_total = invoice_total * 0.5, payment_date = due_date
WHERE client_id =
				(SELECT client_id
				 FROM clients
				 WHERE name='MyWorks');
----------------------------------------------------------------------------------------------------------------------------------------------------------------
UPDATE invoices
SET payment_total = invoice_total * 0.5, payment_date = due_date
WHERE client_id IN
(SELECT client_id
FROM clients
WHERE state IN ('CA','NY'));
----------------------------------------------------------------------------------------------------------------------------------------------------------------
USE sql_store;
UPDATE orders
SET comments = 'Gold customer' 
WHERE customer_id IN
(SELECT customer_id
FROM sustomers
WHERE points > 3000);
----------------------------------------------------------------------------------------------------------------------------------------------------------------
DELETE FROM invoices
WHERE invoice_id = (
SELECT * FROM clients
WHERE name = 'Myworks'
);






















